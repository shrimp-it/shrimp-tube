<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Shrimp Chat â€” End-to-End verschlÃ¼sselter Gruppenchat</title>
  <!-- Styles -->
  <link rel="stylesheet" href="schat.css" />
  <!-- Ably JS SDK -->
  <script src="https://cdn.ably.io/lib/ably.min-1.js"></script>
</head>
<body>
<header>
  <h1>ğŸ¦ Shrimp Chat</h1>
  <div class="status">
    <span id="connStatus" class="muted">Nicht verbunden</span>
  </div>
</header>

<main>
  <!-- Left: Setup & Credentials -->
  <div class="card">
    <h2>Setup und Zugangsdaten</h2>
    <div class="section">
      <div class="panel-note">
        Diese App ist serverless. Nachrichten werden clientseitig mit AESâ€‘GCM verschlÃ¼sselt. Ably transportiert nur Ciphertext.
      </div>
      <div class="sep"></div>

      <div class="grid2">
        <div>
          <label>API Key (Ably)</label>
          <input id="apiKey" type="text" placeholder="Dein Ably API Key" />
          <div class="hint">Wird nur lokal im Browser genutzt. Export/Import speichert den Key mit ab.</div>
        </div>
        <div>
          <label>Client ID (Username)</label>
          <input id="clientId" type="text" placeholder="z.B. shrimp-anna" />
          <div class="row">
            <button id="genClientId">Neu generieren</button>
          </div>
        </div>
      </div>

      <div class="sep"></div>
      <div class="grid2">
        <div>
          <label>Room Name</label>
          <input id="roomName" type="text" placeholder="z.B. reef-lounge" />
          <div class="hint">Wird als Channel-Name verwendet.</div>
        </div>
        <div>
          <label>Room Secret (Passphrase)</label>
          <input id="roomSecret" type="password" placeholder="mindestens 12 Zeichen" />
          <div class="row">
            <button id="genSecret">Generieren</button>
          </div>
        </div>
      </div>

      <div class="sep"></div>
      <div class="row">
        <button id="connectBtn" class="primary">Verbinden & Raum beitreten</button>
        <button id="leaveBtn" class="danger" disabled>Raum verlassen</button>
      </div>

      <div class="sep"></div>
      <h3 class="small">Export/Import</h3>
      <div class="grid2">
        <div>
          <label>Export User Credentials</label>
          <div class="row">
            <button id="exportUser">Als Datei exportieren</button>
          </div>
          <div class="hint">Speichert ${username}-usr-credentials.txt</div>
        </div>
        <div>
          <label>Export Room Credentials</label>
          <div class="row">
            <button id="exportRoom">Als Datei exportieren</button>
          </div>
          <div class="hint">Speichert ${chatroom}-room-credentials.txt</div>
        </div>
      </div>

      <div class="sep"></div>
      <div class="grid2">
        <div>
          <label>Import User Credentials (.txt)</label>
          <input id="importUserFile" type="file" accept=".txt,.json" />
          <div class="row">
            <button id="importUser">Importieren</button>
          </div>
        </div>
        <div>
          <label>Import Room Credentials (.txt)</label>
          <input id="importRoomFile" type="file" accept=".txt,.json" />
          <div class="row">
            <button id="importRoom">Importieren</button>
          </div>
        </div>
      </div>

      <div class="sep"></div>
      <div>
        <label>Log</label>
        <div id="log" class="log"></div>
      </div>
    </div>
  </div>

  <!-- Right: Chat & Presence -->
  <div class="card chat">
    <h2>Chat & Presence</h2>
    <div class="section">
      <div class="row wrap">
        <div><strong>Channel:</strong> <span id="channelName" class="mono">â€“</span></div>
        <div><strong>Key-ID:</strong> <span id="keyInfo" class="mono">â€“</span></div>
      </div>
      <div class="sep"></div>
      <div>
        <label>Anwesend</label>
        <div id="presence" class="presence"></div>
      </div>
    </div>
    <div id="messages" class="messages"></div>
    <div class="chat-input">
      <input id="chatInput" type="text" placeholder="Nachricht eingeben und Enter drÃ¼ckenâ€¦" disabled />
      <button id="sendBtn" class="primary" disabled>Senden</button>
    </div>
  </div>
</main>

<footer>
  Shrimp Chat â€¢ Clientâ€‘seitige Endeâ€‘zuâ€‘Endeâ€‘VerschlÃ¼sselung mit AESâ€‘GCM â€¢ Demo
</footer>

<!-- Scripts -->
<script src="schat.js"></script>
</body>
</html>
